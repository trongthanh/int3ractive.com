---
layout: post
title: 'Tutorial: Realistic Waterfall with CSS3'
date: '2012-04-18T17:02:00.001+07:00'
author: Trọng Thanh Trần
tags:
- Tutorial
- Labs
- HTML5
modified_time: '2012-04-18T17:02:23.171+07:00'
thumbnail: http://1.bp.blogspot.com/-QkKrcdYj0Ss/T46PEw6JquI/AAAAAAAAEV8/4OJaY0bZSFI/s72-c/realistic-css3-waterfall.jpg
blogger_id: tag:blogger.com,1999:blog-5363322361445724369.post-1595713985577766787
blogger_orig_url: http://blog.int3ractive.com/2012/04/tutorial-realistic-waterfall-with-css3.html
---

A recent project requires me to create a realistic running waterfall. For such task, what came first to my mind was to use animated GIF or PNG sprite sheet and loop them frame by frame. Then my friend, Justin, explored more with a semi-transparent water layer overlaying a static waterfall image using Photoshop &amp; Flash. The result was really satisfying. So I decide to adopt it into our project which is pure HTML. Thanks to CSS' background repeat and the new CSS3's animation, the task was really simple to achieve and straight forward.<br />
<br />
Here's the demo &amp; source code on Dabblet:&nbsp;<a href="http://dabblet.com/gist/2403656">http://dabblet.com/gist/2403656</a><br />
<div class="separator" style="clear: both; text-align: center;">
</div>
<div class="separator" style="clear: both; text-align: center;">
<a href="http://dabblet.com/gist/2403656" style="margin-left: 1em; margin-right: 1em;" target="_blank"><img border="0" height="200" src="http://1.bp.blogspot.com/-QkKrcdYj0Ss/T46PEw6JquI/AAAAAAAAEV8/4OJaY0bZSFI/s400/realistic-css3-waterfall.jpg" width="400" /></a></div>
<br />
It is worth noting that CSS3's animation is still an experiment feature. You can still achieve same result using JS to shift the background at intervals.<br />
<br />
Let me explain step by step to re-create the effect:<br />
<a name='more'></a><br />
<h3>
The images</h3>
1. Find a nice <a href="http://www.deviantart.com/download/54948872/Waterfall_n_Mossy_Rocks_Stock_by_Enchantedgal_Stock.jpg" rel="nofollow" target="_blank">waterfall photo</a>, open it in Photoshop<br />
<br />
2. Use magic wand / color range selection / lasso tool... to select waterfall area<br />
<br />
3. Use feather / quick mask to soften the edges<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="http://4.bp.blogspot.com/-9MOaRWrwtS8/T46GCyDfKlI/AAAAAAAAEVE/Tdr-Q7dkZVw/s1600/01-masking.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="235" src="http://4.bp.blogspot.com/-9MOaRWrwtS8/T46GCyDfKlI/AAAAAAAAEVE/Tdr-Q7dkZVw/s400/01-masking.png" width="400" /></a></div>
<br />
4. Invert selection &gt; copy selection to new layer &gt; receive draft "mask" for waterfall (the waterfall area is see-through)<br />
<br />
5.&nbsp;On the draft mask layer, make a rectangle selection around the "hole" we just "punched", make sure it fully cover the semi-transparent soft edges &gt; invert selection &gt; delete. This leaves a smaller rectangle mask around the white water area. Remember the rectangle's offset from the original waterfall image. You'll need it later. Duplicate the layer to new document &gt; crop it &gt; save it as waterfall-mask.png<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="http://1.bp.blogspot.com/-VlCvoRKuJfw/T46G7LeBAbI/AAAAAAAAEVM/mZrN5aj4UV0/s1600/waterfall-mask.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="320" src="http://1.bp.blogspot.com/-VlCvoRKuJfw/T46G7LeBAbI/AAAAAAAAEVM/mZrN5aj4UV0/s320/waterfall-mask.png" width="114" /></a></div>
<br />
6. Copy the water running part of the waterfall to new document.<br />
<br />
7. Resize its canvas to fit the mask above.<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="http://2.bp.blogspot.com/-TN5lG9BslHU/T46HPd6mMhI/AAAAAAAAEVU/lGMGutCLrA0/s1600/02-waterfall-canvas.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="235" src="http://2.bp.blogspot.com/-TN5lG9BslHU/T46HPd6mMhI/AAAAAAAAEVU/lGMGutCLrA0/s400/02-waterfall-canvas.png" width="400" /></a></div>
<br />
8. If using Photoshop CS5+: select part of the water fall &gt; select invert &gt; fill &gt; content aware<br />
If older Photoshop / other software: use clone tool&nbsp;manually fill the other area with waterfall pattern.<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="http://2.bp.blogspot.com/-CQnuNEivK6Q/T46HalxHmEI/AAAAAAAAEVc/6iHF2kfkae4/s1600/02-waterfall-pattern.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="235" src="http://2.bp.blogspot.com/-CQnuNEivK6Q/T46HalxHmEI/AAAAAAAAEVc/6iHF2kfkae4/s400/02-waterfall-pattern.png" width="400" /></a></div>
<br />
9. To make seamless loop, double canvas' height &gt; duplicate the waterfall layer &gt; flip it vertically and move it to the bottom half of the larger canvas.<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="http://3.bp.blogspot.com/--PUAoasr0Uw/T46HslNG7KI/AAAAAAAAEVk/fZzP6YTrdxw/s1600/03-waterfall-loop.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="235" src="http://3.bp.blogspot.com/--PUAoasr0Uw/T46HslNG7KI/AAAAAAAAEVk/fZzP6YTrdxw/s400/03-waterfall-loop.png" width="400" /></a></div>
<br />
10. Reduce opacity to 50% and save it as waterfall-loop.png<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="http://2.bp.blogspot.com/-IMt09pdOi6I/T46H7fQGHJI/AAAAAAAAEVs/PoWMHoTsgDk/s1600/waterfall-loop.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="320" src="http://2.bp.blogspot.com/-IMt09pdOi6I/T46H7fQGHJI/AAAAAAAAEVs/PoWMHoTsgDk/s320/waterfall-loop.png" width="56" /></a></div>
<br />
<br />
11. On the original waterfall, make selection of the waterfall area from the mask &gt; use motion blur to make the water blurry vertically. &gt; save this as waterfall.jpg<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="http://4.bp.blogspot.com/-43tyWT3Fbng/T46IF2iQCqI/AAAAAAAAEV0/hltyMywCS40/s1600/waterfall.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="267" src="http://4.bp.blogspot.com/-43tyWT3Fbng/T46IF2iQCqI/AAAAAAAAEV0/hltyMywCS40/s320/waterfall.jpg" width="320" /></a></div>
<br />
<h3>
The code</h3>
<h4>
HTML:</h4>
Make 1 waterfall container which contains 2 layer: waterfall-loop &amp; waterfall-mask<br />
<div>
<script src="https://gist.github.com/2403656.js?file=dabblet.html">
</script></div>
<h4>
CSS:</h4>
More explanation in the code comments:<br />
<div>
<script src="https://gist.github.com/2403656.js?file=dabblet.css">
</script></div>
<h3>
Final thoughts</h3>
Thanks to CSS' background repeat, the loop is ridiculously simple to create, no need for complicate background looping technique.<br />
<br />
This technique only work for waterfall photo which was captured from direct angle and the water flow running vertically. For other angles, it may be tricky. It can also be applied&nbsp;for river with water moving horizontally.