---
layout: post
title: Using Flash Proxy Class
date: '2010-05-11T14:07:00.001+07:00'
author: Trọng Thanh Trần
tags:
- Labs
- Flash
modified_time: '2011-05-06T12:49:32.887+07:00'
blogger_id: tag:blogger.com,1999:blog-5363322361445724369.post-8953969072662446152
blogger_orig_url: http://blog.int3ractive.com/2010/05/using-flash-proxy-class.html
---

<p>According to <a href="http://livedocs.adobe.com/livecycle/8.2/programLC/common/langref/flash/utils/Proxy.html" target="_blank">Adobe’s Help</a>, the <strong>Proxy</strong> class (flash.utils.Proxy) lets you override the default behavior of ActionScript operations (such as retrieving and modifying properties) on an object.</p>  <p>The usage note sounds interesting but this is one of the least used classes in AS3. In fact there are some use cases of this class which prove it is extremely powerful and may help you save many lines of code. Some of those are:</p>  <ul>   <li>OrderedObject: an object whose properties order are strictly maintained. </li>    <li>TraversableObject: an object which allow you to traverse through its declared properties by using <font face="Courier New">for</font> loop. </li> </ul>  <p>First let’s see how to use it.</p> <a name='more'></a>  <h4><font size="4">The Proxy Class</font></h4>  <p>The Proxy class is meant to be extended. In your own class definition, you must override some special methods of Proxy class which are responsible for some object operations in AS. </p>  <p>They are:</p>  <p>Override this when you want to set property, i.e <font face="Courier New">MyObject.myProperty = “something”;</font></p>  <div class="actionscript3">   <div class="de1">override flash_proxy <span class="kw3">function</span> <span class="kw7">setProperty</span><span class="br0">(</span><span class="kw7">name</span><span class="sy0">:*,</span> <span class="kw7">value</span><span class="sy0">:*</span><span class="br0">)</span><span class="sy0">:</span> <span class="kw1">void</span> <span class="br0">{</span>&#160;&#160; <span class="br0">}</span></div> </div>  <p>Override this when you want to get property, i.e <font face="Courier New">trace(MyObject.myProperty);</font></p>  <div class="actionscript3">   <div class="de1">override flash_proxy <span class="kw3">function</span> <span class="kw7">getProperty</span><span class="br0">(</span><span class="kw7">name</span><span class="sy0">:*</span><span class="br0">)</span><span class="sy0">:*</span> <span class="br0">{</span>&#160;&#160; <span class="br0">}</span></div> </div>  <p>Override these when you need to traverse through properties with <font face="Courier New">for..in</font> or <font face="Courier New">for each..in</font></p>  <div class="actionscript3">   <ol>     <li class="li1">       <div class="de1">override flash_proxy <span class="kw3">function</span> <span class="kw7">nextNameIndex</span> <span class="br0">(</span><span class="kw7">index</span><span class="sy0">:</span> <a href="http://www.google.com/search?q=int%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:int.html"><span class="kw5">int</span></a><span class="br0">)</span><span class="sy0">:</span> <a href="http://www.google.com/search?q=int%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:int.html"><span class="kw5">int</span></a> <span class="br0">{</span> <span class="br0">}</span>&#160; </div>     </li>      <li class="li1">       <div class="de1">override flash_proxy <span class="kw3">function</span> <span class="kw7">nextName</span><span class="br0">(</span><span class="kw7">index</span><span class="sy0">:</span> <a href="http://www.google.com/search?q=int%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:int.html"><span class="kw5">int</span></a><span class="br0">)</span><span class="sy0">:</span> <a href="http://www.google.com/search?q=string%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:string.html"><span class="kw5">String</span></a> <span class="br0">{</span> <span class="br0">}</span></div>     </li>      <li class="li1">       <div class="de1">override flash_proxy <span class="kw3">function</span> <span class="kw7">nextValue</span><span class="br0">(</span><span class="kw7">index</span><span class="sy0">:</span> <a href="http://www.google.com/search?q=int%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:int.html"><span class="kw5">int</span></a><span class="br0">)</span><span class="sy0">:</span> <span class="sy0">*</span> <span class="br0">{</span> <span class="br0">}</span></div>     </li>   </ol> </div>  <p>Override this when you call object’s method <font face="Courier New">hasOwnProperty()</font></p>  <div class="actionscript3">   <div class="de1">override flash_proxy <span class="kw3">function</span> <span class="kw7">hasProperty</span><span class="br0">(</span><span class="kw7">name</span><span class="sy0">:</span> <span class="sy0">*</span><span class="br0">)</span><span class="sy0">:</span> <a href="http://www.google.com/search?q=boolean%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:boolean.html"><span class="kw5">Boolean</span></a> <span class="br0">{</span> <span class="br0">}</span></div> </div>  <p>Override this when there’s a need to delete properties with <font face="Courier New">delete</font> operator.</p>  <div class="actionscript3">   <div class="de1">override flash_proxy <span class="kw3">function</span> <span class="kw7">deleteProperty</span><span class="br0">(</span><span class="kw7">name</span><span class="sy0">:</span> <span class="sy0">*</span><span class="br0">)</span><span class="sy0">:</span> <a href="http://www.google.com/search?q=boolean%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:boolean.html"><span class="kw5">Boolean</span></a> <span class="br0">{</span> <span class="br0">}</span></div> </div>  <p>Override this if you want to use descedant (..) operator with your object. Normally, the descendant operator only available in E4X objects. One example for this operation: you want to get <font face="Courier New">MyObject..myProp</font> which will recursively traverse through the object’s properties and the properties’ properties etc. and return an array of values whose name is <font face="Courier New">myProp</font></p>  <div class="actionscript3">   <div class="de1">override flash_proxy <span class="kw3">function</span> <span class="kw7">getDescendants</span><span class="br0">(</span><span class="kw7">name</span><span class="sy0">:*</span><span class="br0">)</span><span class="sy0">:</span> <span class="sy0">*</span> <span class="br0">{</span> <span class="br0">}</span></div> </div>  <p>Please note: </p>  <ul>   <li>Your Proxy-extended class will have no default behaviour for object operations. Flash Player will throw exceptions for any operations that are not defined by you in your custom class. </li>    <li>Most of these operations only affect dynamic properties. For example: if you have a declared member “prop”, when you get <font face="Courier New">obj.prop</font>, your object will return the value of “prop” directly and the method <span class="kw7"><font face="Courier New">getProperty()</font></span> is not invoked. </li> </ul>  <p>Let’s take a look at some use cases to understand more about Proxy.</p>  <h4><font size="4">OrderedObject&#160; (</font><a title="Link to source on Google Code" href="https://thanhtran-sources.googlecode.com/svn/trunk/demos/FlashProxy/src/org/thanhtran/model/data/OrderedObject.as" target="_blank"><font size="4">source code</font></a><font size="4">)</font></h4>  <p>As you may notice, when you iterate through an object with <font face="Courier New">for</font> loop, you don’t access its properties in the order you created them. For example:</p>  <div class="actionscript3"><span class="kw2">var</span> obj<span class="sy0">:</span> <a href="http://www.google.com/search?q=object%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:object.html"><span class="kw5">Object</span></a> = <span class="br0">{</span>a<span class="sy0">:</span> <span class="nu0">1</span><span class="sy0">,</span> <span class="kw7">b</span><span class="sy0">:</span> <span class="nu0">2</span><span class="sy0">,</span> <span class="kw7">c</span><span class="sy0">:</span> <span class="nu0">3</span><span class="br0">}</span><span class="sy0">;</span>     <br />obj<span class="sy0">.</span><span class="kw7">d</span> = <span class="nu0">4</span><span class="sy0">;</span>     <br />obj<span class="sy0">.</span>e = <span class="nu0">5</span><span class="sy0">;</span>     <br /><span class="kw1">for</span> <span class="br0">(</span><span class="kw2">var</span> prop<span class="sy0">:</span> <a href="http://www.google.com/search?q=string%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:string.html"><span class="kw5">String</span></a> <span class="kw1">in</span> obj<span class="br0">)</span> <span class="br0">{</span>     <br />&#160;&#160;&#160; <span class="kw7">trace</span><span class="br0">(</span>prop <span class="sy0">+</span> <span class="st0">&quot; - &quot;</span> <span class="sy0">+</span> obj<span class="br0">[</span>prop<span class="br0">]</span><span class="br0">)</span><span class="sy0">;</span> <span class="co1">// not in order 1, 2, 3, 4, 5 </span>    <br /><span class="br0">}</span></div>  <p>This issue of order, most of the time, is acceptable. However, there are cases where the order of properties is very important. For example: a QueryString object which parse this string “a=1&amp;b=2&amp;c=3&amp;d=4&amp;e=5” and hold all the values in its dynamic properties. Unfortunately, when you iterate the properties list and return the string back, the output are not the same with input anymore. Imagine you use this class to work with <a href="http://www.asual.com/swfaddress/" target="_blank">SWFAddress</a>, you will get 2 different URLs for the same page access (the browser will see <font color="#0000ff">http://yourdomain.com/?a=1&amp;b=2&amp;c=3&amp;d=4&amp;e=5</font> different from <font color="#0000ff">http://yourdomain.com/?c=3&amp;d=4&amp;a=1&amp;e=5&amp;b=2</font>).</p>  <p>With <strong>OrderedObject </strong>and its extension <strong>QueryString</strong>, I can solve the above issue.</p>  <p>OrderedObject example:</p>  <div class="actionscript3"><span class="kw1">import</span> org<span class="sy0">.</span>thanhtran<span class="sy0">.</span>model<span class="sy0">.</span><span class="kw7">data</span><span class="sy0">.</span>OrderedObject<span class="sy0">;</span>     <br />    <br /><span class="kw2">var</span> obj<span class="sy0">:</span> OrderedObject = <span class="kw1">new</span> OrderedObject<span class="br0">(</span> <span class="br0">[</span><span class="st0">&quot;a&quot;</span><span class="sy0">,</span> <span class="nu0">1</span><span class="sy0">,</span> <span class="st0">&quot;b&quot;</span><span class="sy0">,</span> <span class="nu0">2</span><span class="sy0">,</span> <span class="st0">&quot;c&quot;</span><span class="sy0">,</span> <span class="nu0">3</span><span class="br0">]</span> <span class="br0">)</span><span class="sy0">;</span>     <br />obj<span class="sy0">.</span><span class="kw7">d</span> = <span class="nu0">4</span><span class="sy0">;</span>     <br />obj<span class="sy0">.</span>e = <span class="nu0">5</span><span class="sy0">;</span>     <br /><span class="kw1">for</span> <span class="br0">(</span><span class="kw2">var</span> prop<span class="sy0">:</span> <a href="http://www.google.com/search?q=string%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:string.html"><span class="kw5">String</span></a> <span class="kw1">in</span> obj<span class="br0">)</span> <span class="br0">{</span>     <br />&#160;&#160;&#160; <span class="kw7">trace</span><span class="br0">(</span>prop <span class="sy0">+</span> <span class="st0">&quot; - &quot;</span> <span class="sy0">+</span> obj<span class="br0">[</span>prop<span class="br0">]</span><span class="br0">)</span><span class="sy0">;</span> <span class="co1">//in order a – 1, b – 2, c – 3, d – 4, e – 5 </span>    <br /><span class="br0">}</span> </div>  <p>QueryString example:</p>  <div class="actionscript3"><span class="kw1">import</span> org<span class="sy0">.</span>thanhtran<span class="sy0">.</span>model<span class="sy0">.</span><span class="kw7">data</span><span class="sy0">.</span>QueryString<span class="sy0">;      <br /></span>    <br /><span class="kw2">var</span> query<span class="sy0">:</span> QueryString = <span class="kw1">new</span> QueryString<span class="br0">(</span><span class="st0">&quot;a=1&amp;b=2&amp;c=3&amp;d=4&amp;e=5&quot;</span><span class="br0">)</span><span class="sy0">;</span>     <br /><span class="kw7">trace</span><span class="br0">(</span>query<span class="sy0">.</span><span class="kw7">toString</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span> <span class="co1">//a=1&amp;b=2&amp;c=3&amp;d=4&amp;e=5 </span>    <br /><span class="co1">//change parameters </span>    <br />query<span class="sy0">.</span>a = <span class="st0">&quot;one&quot;</span><span class="sy0">;</span>     <br />query<span class="sy0">.</span>e = <span class="st0">&quot;five&quot;</span><span class="sy0">;</span>     <br /><span class="kw7">trace</span><span class="br0">(</span>query<span class="sy0">.</span><span class="kw7">toString</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span> <span class="co1">//a=one&amp;b=2&amp;c=3&amp;d=4&amp;e=five</span></div>  <h4><font size="4">TraversableObject (</font><a title="Link to source on Google Code" href="https://thanhtran-sources.googlecode.com/svn/trunk/demos/FlashProxy/src/org/thanhtran/model/data/TraversableObject.as" target="_blank"><font size="4">source code</font></a><font size="4">)</font></h4>  <p>Say, your project may have a few data objects (AKA value objects) which are used to transfer data among components. There a times you want to iterate through their properties list to quickly copy the values or something. However, it is impossible to use <font face="Courier New">for..in</font> and <font face="Courier New">for each..in</font> statement to iterate declared properties.</p>  <p>By extending <strong>TraversableObject</strong> (which is an implementation of Proxy), your object properties can now be iterated through with <font face="Courier New">for</font> loop.</p>  <p>Here’s how:</p>  <div class="actionscript3"><span class="kw1">public</span> <span class="kw4">class</span> MyObject <span class="kw1">extends</span> TraversableObject <span class="br0">{</span>     <br />&#160;&#160;&#160; <span class="kw1">public</span> <span class="kw2">var</span> a<span class="sy0">:</span> <a href="http://www.google.com/search?q=string%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:string.html"><span class="kw5">String</span></a> = <span class="st0">&quot;1&quot;</span><span class="sy0">;</span>     <br />&#160;&#160;&#160; <span class="kw1">public</span> <span class="kw2">var</span> <span class="kw7">b</span><span class="sy0">:</span> <a href="http://www.google.com/search?q=int%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:int.html"><span class="kw5">int</span></a> = <span class="nu0">2</span><span class="sy0">;</span>     <br />&#160;&#160;&#160; <span class="kw1">public</span> <span class="kw2">var</span> <span class="kw7">c</span><span class="sy0">:</span> <a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html"><span class="kw5">Number</span></a> = <span class="nu0">3</span><span class="sy0">;</span>     <br />    <br />&#160;&#160;&#160; <span class="kw1">public</span> <span class="kw3">function</span> MyObject<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="co1">//list all the public properties you want to iterate here </span>    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="co1">//DO NOT list private or dynamic ones </span>    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; propertyList = <span class="br0">[</span><span class="st0">&quot;a&quot;</span><span class="sy0">,</span> <span class="st0">&quot;b&quot;</span><span class="sy0">,</span> <span class="st0">&quot;c&quot;</span><span class="br0">]</span><span class="sy0">;</span>     <br />&#160;&#160;&#160; <span class="br0">}</span>     <br /><span class="br0">}</span>     <br /><span class="co2">/* … */</span>     <br /><span class="kw2">var</span> obj<span class="sy0">:</span> MyObject = <span class="kw1">new</span> MyObject<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>     <br /><span class="kw1">for</span> <span class="br0">(</span><span class="kw2">var</span> prop<span class="sy0">:</span> <a href="http://www.google.com/search?q=string%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:string.html"><span class="kw5">String</span></a> <span class="kw1">in</span> obj<span class="br0">)</span> <span class="br0">{</span>     <br />&#160;&#160;&#160; <span class="kw7">trace</span><span class="br0">(</span>prop <span class="sy0">+</span> <span class="st0">&quot; - &quot;</span> <span class="sy0">+</span> obj<span class="br0">[</span>prop<span class="br0">]</span><span class="br0">)</span><span class="sy0">;</span> <span class="co1">//in order a – 1, b – 2, c – 3 </span>    <br /><span class="br0">}</span>     <br />&#160;</div>  <p>You can check out the demo FlashDevelop project <a href="https://thanhtran-sources.googlecode.com/svn/trunk/demos/FlashProxy" target="_blank">here</a>.</p>  <p>These are just some practical applications of Proxy class, I think there must be plenty of circumstances where this special class proves useful.</p>  <p><font size="1">[Vietnamese tags: Sử dụng lớp Proxy của Flash: thay đổi cách truy xuất và các thao tác lên đối tượng trong ActionScript]</font></p>  