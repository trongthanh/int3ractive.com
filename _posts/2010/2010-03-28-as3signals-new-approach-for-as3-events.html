---
layout: post
title: 'as3signals: new approach for AS3 Events'
date: '2010-03-28T22:24:00.002+07:00'
author: Trọng Thanh Trần
tags:
- Labs
- Flash
- Libraries
modified_time: '2011-05-06T12:49:32.892+07:00'
blogger_id: tag:blogger.com,1999:blog-5363322361445724369.post-4028328242571488603
blogger_orig_url: http://blog.int3ractive.com/2010/03/as3signals-new-approach-for-as3-events.html
---

There are times you may find that the built-in events of AS3 are limited and even troublesome. Here are some circumstances that EventDispatchers turn against developers:   <br />  <ol>   <li><strong>Objects MUST extend EventDispatcher</strong> in order to be able to dispatch events. Implementing IEventDispatcher alone is impossible because the event target is read-only and you cannot change it from outside of EventDispatcher. </li>    <li><strong>It’s difficult to manage events</strong>. There’s no way you can remove all event handlers attached to an event dispatcher at once. So in some cases, you don’t remove them properly and they start causing bugs. (BTW, using weak references is not reliable and not recommended.) </li>    <li>You<strong> cannot pass extra data to you listener</strong> unless you extends a new Event object </li>    <li>You<strong> cannot set up your interface</strong> in a way that it can enforce implementing classes to dispatch the required events. </li>    <li>On performance perspective, creating objects is one of the most evil things. That’s why any advanced programmers must know and practically use objects pool. However, we are still<strong> wasting a lot of resources creating event objects</strong>, especially repetitive events like mouse move or enter frame. </li>    <li>Read <a href="http://robertpenner.com/flashblog/2009/09/my-critique-of-as3-events-part-2.html" target="_blank">here</a> for more critiques on AS3 events </li> </ol> So in order to address those issues, <a href="http://robertpenner.com/flashblog/" target="_blank">Robert Penner</a> has adopted an alternative to AS3 events namely <a href="http://github.com/robertpenner/as3-signals" target="_blank">as3signals</a>. (Follow the link for more info and get the library) <a name='more'></a>  <br />Here’s the briefing from <a href="http://wiki.github.com/robertpenner/as3-signals/" target="_blank">as3signals wiki page</a>:   <br />  <blockquote><strong><span style="font-size: small">Signals: Think Outside the Event.</span></strong>     <br />Signals are light-weight, strongly-typed AS3 messaging tools.     <br />Wire your application with better APIs and less boilerplate than AS3 Events.     <br /><strong>Concept</strong>     <br />    <ul>     <li>A Signal is essentially a mini-dispatcher specific to one event, with its own array of listeners. </li>      <li>A Signal gives an event a concrete membership in a class. </li>      <li>Listeners subscribe to real objects, not to string-based channels. </li>      <li>Event string constants are no longer needed. </li>      <li>Signals are inspired by C# events and signals/slots in Qt. </li>   </ul> </blockquote> Let’s see how as3signals gains advantages over AS3 events:   <br />  <h4>1. Any object can dispatch events</h4> Here’s how you create an event dispatching object with Signals:   <br />  <div class="actionscript3">   <ol>     <li class="li1">       <div class="de1"><span class="kw1">import</span> org<span class="sy0">.</span>osflash<span class="sy0">.</span>signals<span class="sy0">.</span>Signal<span class="sy0">;</span></div>     </li>      <li class="li1">       <div class="de1"><span class="kw1">public</span> <span class="kw4">class</span> Radio <span class="br0">{</span></div>     </li>      <li class="li1">       <div class="de1"></div>     </li>      <li class="li1">       <div class="de1">&#160;&#160;&#160; <span class="co1">// This is the public API to which listeners subscribe.</span></div>     </li>      <li class="li2">       <div class="de2">&#160;&#160;&#160; <span class="kw1">public</span> <span class="kw2">var</span> messageChanged<span class="sy0">:</span>Signal<span class="sy0">;</span></div>     </li>      <li class="li1">       <div class="de1">&#160;&#160;&#160; <span class="kw1">private</span> <span class="kw2">var</span> _message<span class="sy0">:</span><a href="http://www.google.com/search?q=string%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:string.html"><span class="kw5">String</span></a><span class="sy0">;</span></div>     </li>      <li class="li1">       <div class="de1">&#160;&#160;&#160; </div>     </li>      <li class="li1">       <div class="de1">&#160;&#160;&#160; <span class="kw1">public</span> <span class="kw3">function</span> Radio<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span></div>     </li>      <li class="li1">       <div class="de1">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="co1">// Create a Signal that dispatches a String.</span></div>     </li>      <li class="li2">       <div class="de2">&#160;&#160;&#160;&#160;&#160;&#160;&#160; messageChanged = <span class="kw1">new</span> Signal<span class="br0">(</span><a href="http://www.google.com/search?q=string%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:string.html"><span class="kw5">String</span></a><span class="br0">)</span><span class="sy0">;</span></div>     </li>      <li class="li1">       <div class="de1">&#160;&#160;&#160; <span class="br0">}</span></div>     </li>      <li class="li1">       <div class="de1">&#160;&#160;&#160; </div>     </li>      <li class="li1">       <div class="de1">&#160;&#160;&#160; <span class="kw1">public</span> <span class="kw3">function</span> <span class="kw1">get</span> <span class="kw7">message</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">:</span><a href="http://www.google.com/search?q=string%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:string.html"><span class="kw5">String</span></a> <span class="br0">{</span> <span class="kw1">return</span> _message<span class="sy0">;</span> <span class="br0">}</span></div>     </li>      <li class="li1">       <div class="de1">&#160;&#160;&#160; </div>     </li>      <li class="li2">       <div class="de2">&#160;&#160;&#160; <span class="co1">// The setter uses the Signal to dispatch the changed value.</span></div>     </li>      <li class="li1">       <div class="de1">&#160;&#160;&#160; <span class="kw1">public</span> <span class="kw3">function</span> <span class="kw1">set</span> <span class="kw7">message</span><span class="br0">(</span><span class="kw7">value</span><span class="sy0">:</span><a href="http://www.google.com/search?q=string%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:string.html"><span class="kw5">String</span></a><span class="br0">)</span><span class="sy0">:</span><span class="kw1">void</span> <span class="br0">{</span></div>     </li>      <li class="li1">       <div class="de1">&#160;&#160;&#160;&#160;&#160;&#160;&#160; _message = <span class="kw7">value</span><span class="sy0">;</span></div>     </li>      <li class="li1">       <div class="de1">&#160;&#160;&#160;&#160;&#160;&#160;&#160; messageChanged<span class="sy0">.</span>dispatch<span class="br0">(</span>_message<span class="br0">)</span><span class="sy0">;</span></div>     </li>      <li class="li1">       <div class="de1">&#160;&#160;&#160; <span class="br0">}</span></div>     </li>      <li class="li2">       <div class="de2"><span class="br0">}</span></div>     </li>   </ol> </div> Here’s how you add event listeners:   <br />  <div class="actionscript3">   <ol>     <li class="li1">       <div class="de1"><span class="kw2">var</span> radio<span class="sy0">:</span> Radio = <span class="kw1">new</span> Radio<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span></div>     </li>      <li class="li1">       <div class="de1"><span class="co1">// Hook the listener up to the Radio's Signal.</span></div>     </li>      <li class="li1">       <div class="de1">radio<span class="sy0">.</span>messageChanged<span class="sy0">.</span><span class="kw7">add</span><span class="br0">(</span>messageChangedHandler<span class="br0">)</span><span class="sy0">;</span></div>     </li>      <li class="li1">       <div class="de1"></div>     </li>      <li class="li2">       <div class="de2"><span class="kw3">function</span> messageChangedHandler<span class="br0">(</span><span class="kw7">message</span><span class="sy0">:</span> <a href="http://www.google.com/search?q=string%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:string.html"><span class="kw5">String</span></a><span class="br0">)</span><span class="sy0">:</span> <span class="kw1">void</span> <span class="br0">{</span></div>     </li>      <li class="li1">       <div class="de1">&#160;&#160;&#160; <span class="kw7">trace</span><span class="br0">(</span><span class="st0">&quot;heard message: &quot;</span> <span class="sy0">+</span> <span class="kw7">message</span><span class="br0">)</span><span class="sy0">;</span></div>     </li>      <li class="li1">       <div class="de1"><span class="br0">}</span></div>     </li>   </ol> </div>  <h4>2. With signals, managing events is much less hassle</h4> You can remove all event handlers with one convenient method:   <br />  <div class="actionscript3">signal.removeAll();</div> You can retrieve number of listeners:   <br />  <div class="actionscript3">signal.numListeners;</div> You can add a listener that will be removed automatically after just one event:   <br />  <div class="actionscript3">signal<span class="sy0">.</span>addOnce<span class="br0">(</span>theListener<span class="br0">)</span><span class="sy0">;</span> <span class="co1">// result: signal has one listener</span>     <br />signal<span class="sy0">.</span>dispatch<span class="br0">(</span>theEvent<span class="br0">)</span><span class="sy0">;</span>&#160;&#160; <span class="co1">// result: theListener is called, signal now has no listeners</span> </div>  <h4>3. You can dispatch with any number of arguments to listener</h4> You can define types for your arguments   <br />  <div class="actionscript3"><span class="co1">// A Signal that will dispatch a String and an integer:</span>     <br /><span class="kw7">progress</span> = <span class="kw1">new</span> Signal<span class="br0">(</span><a href="http://www.google.com/search?q=string%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:string.html"><span class="kw5">String</span></a><span class="sy0">,</span> <a href="http://www.google.com/search?q=int%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:int.html"><span class="kw5">int</span></a><span class="br0">)</span><span class="sy0">;</span> </div> Later on, when you dispatch events, as3signals can detect and notify argument error   <br />  <div class="actionscript3"><span class="co1">//later:</span>     <br /><span class="kw7">progress</span><span class="sy0">.</span>dispatch<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span> <span class="co1">// will throw ArgumentError </span>    <br /><span class="kw7">progress</span><span class="sy0">.</span>dispatch<span class="br0">(</span><span class="st0">'The Answer'</span><span class="br0">)</span><span class="sy0">;</span> <span class="co1">// will throw ArgumentError </span>    <br /><span class="kw7">progress</span><span class="sy0">.</span>dispatch<span class="br0">(</span><span class="st0">'The Answer'</span><span class="sy0">,</span> <span class="nu0">42.5</span><span class="br0">)</span><span class="sy0">;</span> <span class="co1">// will throw ArgumentError </span>    <br /><span class="kw7">progress</span><span class="sy0">.</span>dispatch<span class="br0">(</span><span class="st0">'The Answer'</span><span class="sy0">,</span> <span class="nu0">42</span><span class="br0">)</span><span class="sy0">;</span> <span class="co1">// will succeed</span> </div> When adding listeners, they are all so checked for argument types.   <br />  <h4>4. It’s possible that you enforce events in interface </h4> To see an example, please follow this link <a title="http://snipt.org/wSm" href="http://snipt.org/wSm">http://snipt.org/wSm</a>   <br />  <h4>5. It’s performance gain because no event object is created in Signals</h4> But that’s not everything yet. The ultimate deal is to replace ENTER_FRAME event.   <br />As we know that ENTER_FRAME event is the key to time-based animations and are widely used. Normally, ENTER_FRAME event can create 25 – 30 objects per second, that’s 1500-1800 objects per minute. But we are aware that that creating objects is evil. So some guys have tried to replace the ENTER_FRAME event with Signals. Read <a href="http://alecmce.com/as3/replacing-enter_frame" target="_blank">this blog</a> for more info. (The site is currently down, so please use this <a href="http://74.125.153.132/search?q=cache:z4_I5r8RVZkJ:alecmce.com/as3/replacing-enter_frame+http://alecmce.com/as3/replacing-enter_frame&amp;cd=1&amp;hl=vi&amp;ct=clnk&amp;gl=vn" target="_blank">cache from Google</a>)   <br />  <h4>6. Signals only projects</h4> Signals can wrap the native events of AS3 so that the whole project will use a consistent messaging system for communication between components. For example:   <br />  <div class="actionscript3"><span class="kw2">var</span> <span class="kw7">click</span><span class="sy0">:</span>NativeSignal = <span class="kw1">new</span> NativeSignal<span class="br0">(</span><span class="kw1">this</span><span class="sy0">,</span> <a href="http://www.google.com/search?q=mouseevent%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:mouseevent.html"><span class="kw5">MouseEvent</span></a><span class="sy0">.</span><span class="kw8">CLICK</span><span class="sy0">,</span> <a href="http://www.google.com/search?q=mouseevent%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:mouseevent.html"><span class="kw5">MouseEvent</span></a><span class="br0">)</span><span class="sy0">;</span></div> The author also claimed that he’s experimenting <a href="http://wiki.github.com/robertpenner/as3-signals/features" target="_blank">the bubble feature</a> (the ability to forward events among objects in display list).   <br />  <h4>Conclusion</h4> It is still under development and improvement but as3signals’ current feature set can satisfy most common project’s needs. Some guys even love it so much that they branch some frameworks to work purely with Signals, for example:   <br />  <ul>   <li><a href="http://github.com/piercer/puremvc-as3-multicore/tree/as3Signals" target="_blank">PureMVC AS3 Multicore – as3signal branch</a> </li>    <li><a href="http://richtextformat.co.uk/blog/?p=445" target="_blank">RobotSignals – RobotLegs &amp; as3signals combination</a> </li>    <li><a href="http://www.kilometer0.com/blog/code/swfaddress-and-as3signals/" target="_blank">SWFAddress as3signals version</a> </li>    <li>See more examples <a href="http://wiki.github.com/robertpenner/as3-signals/community-examples" target="_blank">here</a> </li> </ul> For now, I see no shortcomings of signals but I’m still skeptical that there might be some disadvantages compared to AS3 events because nothing is perfect. (Please help me pointing them out)   <br />Anyway, it is worth trying as3signals in my upcoming projects to see if it really ‘shines’ in real applications.   <br />(Credit: some of the sample code are revised from this <a href="http://wiki.github.com/robertpenner/as3-signals/hello-world" target="_blank">Hello World example</a>)   <br /><span style="font-size: xx-small">[Vietnamese tags: as3signals: cách tiếp cận mới cho sự kiện (event) trong AS3]</span>  